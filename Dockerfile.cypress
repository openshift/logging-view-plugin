FROM cypress/included:14.5.3

WORKDIR /usr/src/app

ENV HUSKY=0

COPY web/package*.json .
RUN npm ci

COPY web/ /usr/src/app/

RUN mkdir -p /.config
RUN chmod 775 -R /.config

RUN mkdir -p /root/.cache/Cypress
RUN chmod 775 -R /root/.cache

RUN npm run build:standalone

ENTRYPOINT ["npm", "run", "test:e2e"]
